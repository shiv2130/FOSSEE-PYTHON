{% extends "workshop_app/base.html" %}
{% load static %}
{% load custom_filters %}

{% block title %}
    View List of available Workshops
{% endblock %}

{% block extra_css %}
    <!-- Link the new stylesheet for this page -->
    <link rel="stylesheet" href="{% static 'workshop_app/css/workshop_types.css' %}">
{% endblock %}


{% block content %}
<div class="card">
    <div class="card-header">
        <h2>Workshop Types</h2>
        <div>
            <button id="inviteBtn" class="btn btn-secondary">Invite Users</button>
            {% if request.user|has_group:"instructor" %}
                <a href="{% url 'workshop_app:add_workshop_type' %}" class="btn btn-primary">
                    <i class="fas fa-plus"></i>&nbsp;Add Type
                </a>
            {% endif %}
        </div>
    </div>
    <div class="card-body">
        <div class="table-responsive-sm">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Sr No</th>
                        <th>Workshop Name</th>
                        <th>Workshop Duration (Days)</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                {% for w in workshop_type %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ w.name }}</td>
                        <td>{{ w.duration }}</td>
                        <td>
                            <a href="{% url 'workshop_app:workshop_type_details' w.id %}" class="action-link">
                                View Workshop Details
                            </a>
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 2rem;">No workshop types available.</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

        {% if workshop_type.paginator.num_pages > 1 %}
        <div class="pagination-container">
            <ul class="pagination">
                {% if workshop_type.has_previous %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ workshop_type.previous_page_number }}">Previous</a>
                    </li>
                {% endif %}

                <li class="page-item">
                    <span class="current">
                        Page {{ workshop_type.number }} of {{ workshop_type.paginator.num_pages }}
                    </span>
                </li>

                {% if workshop_type.has_next %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ workshop_type.next_page_number }}">Next</a>
                    </li>
                {% endif %}
            </ul>
        </div>
        {% endif %}
    </div>
</div>

<!-- The Modal -->
<div id="mailModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h4>Invite Participants</h4>
        <p style="color: var(--text-light); margin-bottom: 1rem;">Separate multiple Email IDs using a comma (,).</p>
        <form action="{{URL_ROOT}}/share_details/" method="POST">
            {% csrf_token %}
            <label for="email-input">Email:</label>
            <input name="email" id="email-input" type='email' multiple>
            <input type='submit' class="btn btn-primary" style="width: 100%;">
        </form>
    </div>
</div>
{% endblock %}


{% block extra_custom_scripts %}
<script>
    // Get the modal
    var modal = document.getElementById("mailModal");

    // Get the button that opens the modal
    var btn = document.getElementById("inviteBtn");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    // When the user clicks the button, open the modal 
    btn.onclick = function() {
      modal.style.display = "block";
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
      modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }
</script>
{% endblock %}